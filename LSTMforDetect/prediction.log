2025-05-30 00:34:44,323 - __main__ - INFO - 使用设备: cuda
2025-05-30 00:34:44,323 - __main__ - INFO - 开始处理CSV文件: C:\Users\17380\test_dataset.csv
2025-05-30 00:34:44,324 - data - INFO - 加载预处理器从: ./outputs/preprocessor.pkl
2025-05-30 00:34:44,324 - data - INFO - 预处理器已从 ./outputs/preprocessor.pkl 加载，PCA维度: 30
2025-05-30 00:34:44,324 - data - INFO - 预处理器加载成功
2025-05-30 00:34:44,325 - data - INFO - 开始数据处理流水线，模式: 验证
2025-05-30 00:34:44,325 - data - INFO - 开始读取文件: test_dataset.csv
2025-05-30 00:34:44,335 - data - INFO - CSV文件包含 45 个列
2025-05-30 00:34:44,335 - data - INFO - 将读取 45 列: 44 个特征列和 1 个标签列
2025-05-30 00:34:44,392 - data - INFO - 文件 test_dataset.csv 读取完成，shape=(24000, 45)
2025-05-30 00:34:44,393 - data - INFO - 开始数据清洗
2025-05-30 00:34:44,393 - data - INFO - 原始数据形状: (24000, 45)
2025-05-30 00:34:44,417 - data - INFO - 移除重复记录后剩余 23977 条记录
2025-05-30 00:34:44,419 - data - INFO - 处理前缺失值总数: 0
2025-05-30 00:34:44,464 - data - INFO - 处理了 35969 个异常值
2025-05-30 00:34:44,464 - data - INFO - 数据清洗完成，最终形状: (23977, 45)
2025-05-30 00:34:44,464 - data - INFO - 开始特征预处理
2025-05-30 00:34:44,486 - data - INFO - 找到 46 个数值特征
2025-05-30 00:34:44,488 - data - INFO - 验证阶段使用 46 个特征
2025-05-30 00:34:44,546 - data - INFO - PCA降维完成，最终特征维数: 30
2025-05-30 00:34:44,546 - data - INFO - 标签one-hot编码维数: 12
2025-05-30 00:34:44,556 - data - INFO - 最终特征形状: (23977, 30), 标签形状: (23977, 12)
2025-05-30 00:34:44,557 - data - INFO - 类别数量: 12
2025-05-30 00:34:44,557 - data - INFO - 数据处理流水线完成
2025-05-30 00:34:44,558 - data - INFO - 特征数据类型: float64
2025-05-30 00:34:44,559 - data - INFO - 标签数据类型: float64
2025-05-30 00:34:44,563 - data - INFO - 特征形状: torch.Size([23977, 30]), 类型: torch.float32
2025-05-30 00:34:44,563 - data - INFO - 标签形状: torch.Size([23977, 12]), 类型: torch.float32
2025-05-30 00:34:44,563 - data - INFO - 标签类别数: 12
2025-05-30 00:34:44,563 - __main__ - INFO - 数据集大小: 23977
2025-05-30 00:34:44,563 - data - INFO - 开始读取文件: test_dataset.csv
2025-05-30 00:34:44,568 - data - INFO - CSV文件包含 45 个列
2025-05-30 00:34:44,568 - data - INFO - 将读取 45 列: 44 个特征列和 1 个标签列
2025-05-30 00:34:44,635 - data - INFO - 文件 test_dataset.csv 读取完成，shape=(24000, 45)
2025-05-30 00:34:44,636 - __main__ - WARNING - 无法获取Flow ID
2025-05-30 00:34:44,638 - __main__ - INFO - 加载基础模型: ./outputs/checkpoints/best_model.pth
2025-05-30 00:34:44,963 - model - INFO - 初始化GRUDetector: input_size=1, hidden_size=128, num_layers=2, num_classes=12, dropout_rate=0.5, bidirectional=True, model_type=gru
2025-05-30 00:34:45,023 - __main__ - INFO - 创建XGBOOST级联模型...
2025-05-30 00:34:45,039 - model - INFO - 已加载XGBoost分类器: 10 vs 11
2025-05-30 00:34:45,047 - model - INFO - 已加载XGBoost分类器: 5 vs 7
2025-05-30 00:34:45,051 - model - INFO - 已加载XGBoost分类器: 2 vs 8
2025-05-30 00:34:45,054 - model - INFO - 已加载XGBoost分类器: 9 vs 10
2025-05-30 00:34:45,060 - model - INFO - 已加载XGBoost分类器: 0 vs 4
2025-05-30 00:34:45,064 - model - INFO - 已加载XGBoost分类器: 0 vs 9
2025-05-30 00:34:45,064 - __main__ - INFO - 开始预测...
2025-05-30 00:34:55,889 - __main__ - INFO - 批次: 10/188
2025-05-30 00:34:56,520 - __main__ - INFO - 批次: 20/188
2025-05-30 00:34:57,051 - __main__ - INFO - 批次: 30/188
2025-05-30 00:34:57,728 - __main__ - INFO - 批次: 40/188
2025-05-30 00:34:58,240 - __main__ - INFO - 批次: 50/188
2025-05-30 00:34:58,744 - __main__ - INFO - 批次: 60/188
2025-05-30 00:34:59,257 - __main__ - INFO - 批次: 70/188
2025-05-30 00:34:59,763 - __main__ - INFO - 批次: 80/188
2025-05-30 00:35:00,268 - __main__ - INFO - 批次: 90/188
2025-05-30 00:35:00,796 - __main__ - INFO - 批次: 100/188
2025-05-30 00:35:01,319 - __main__ - INFO - 批次: 110/188
2025-05-30 00:35:01,827 - __main__ - INFO - 批次: 120/188
2025-05-30 00:35:02,318 - __main__ - INFO - 批次: 130/188
2025-05-30 00:35:02,796 - __main__ - INFO - 批次: 140/188
2025-05-30 00:35:03,295 - __main__ - INFO - 批次: 150/188
2025-05-30 00:35:03,814 - __main__ - INFO - 批次: 160/188
2025-05-30 00:35:04,285 - __main__ - INFO - 批次: 170/188
2025-05-30 00:35:04,801 - __main__ - INFO - 批次: 180/188
2025-05-30 00:35:05,185 - __main__ - INFO - 批次: 188/188
2025-05-30 00:35:05,662 - __main__ - INFO - 基础模型预测分布: {0: 1629, 4: 2250, 6: 3218, 3: 3380, 7: 2731, 5: 6992, 2: 1621, 10: 1216, 11: 558, 9: 273, 8: 55, 1: 54}
2025-05-30 00:35:05,662 - __main__ - INFO - 最终预测分布: {0: 1595, 4: 2284, 6: 3218, 3: 3380, 7: 2661, 5: 7062, 2: 1645, 10: 659, 11: 1133, 9: 255, 8: 31, 1: 54}
2025-05-30 00:35:05,662 - __main__ - INFO - 使用XGBOOST次数: 777/23977 (3.24%)
2025-05-30 00:35:05,665 - __main__ - INFO - 类别 UDP vs UDP-lag:
2025-05-30 00:35:05,665 - __main__ - INFO -   基础模型: 1216/558
2025-05-30 00:35:05,665 - __main__ - INFO -   最终结果: 659/1133
2025-05-30 00:35:05,665 - __main__ - INFO -   变化: -557/575
2025-05-30 00:35:05,668 - __main__ - INFO - 类别 NetBIOS vs SSDP:
2025-05-30 00:35:05,668 - __main__ - INFO -   基础模型: 6992/2731
2025-05-30 00:35:05,668 - __main__ - INFO -   最终结果: 7062/2661
2025-05-30 00:35:05,668 - __main__ - INFO -   变化: 70/-70
2025-05-30 00:35:05,671 - __main__ - INFO - 类别 LDAP vs Syn:
2025-05-30 00:35:05,671 - __main__ - INFO -   基础模型: 1621/55
2025-05-30 00:35:05,671 - __main__ - INFO -   最终结果: 1645/31
2025-05-30 00:35:05,671 - __main__ - INFO -   变化: 24/-24
2025-05-30 00:35:05,674 - __main__ - INFO - 类别 TFTP vs UDP:
2025-05-30 00:35:05,674 - __main__ - INFO -   基础模型: 273/1216
2025-05-30 00:35:05,674 - __main__ - INFO -   最终结果: 255/659
2025-05-30 00:35:05,674 - __main__ - INFO -   变化: -18/-557
2025-05-30 00:35:05,677 - __main__ - INFO - 类别 BENIGN vs NTP:
2025-05-30 00:35:05,677 - __main__ - INFO -   基础模型: 1629/2250
2025-05-30 00:35:05,677 - __main__ - INFO -   最终结果: 1595/2284
2025-05-30 00:35:05,677 - __main__ - INFO -   变化: -34/34
2025-05-30 00:35:05,679 - __main__ - INFO - 类别 BENIGN vs TFTP:
2025-05-30 00:35:05,679 - __main__ - INFO -   基础模型: 1629/273
2025-05-30 00:35:05,679 - __main__ - INFO -   最终结果: 1595/255
2025-05-30 00:35:05,679 - __main__ - INFO -   变化: -34/-18
2025-05-30 00:35:05,821 - __main__ - INFO - 预测结果已保存到: prediction_results.csv
